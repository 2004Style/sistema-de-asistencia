# ============================================
# CONFIGURACIÓN GENERAL - SISTEMA DE ASISTENCIA
# ============================================
# Este archivo contiene variables de entorno para Docker Compose
# Copiar a .env en producción y rellenar con valores reales

# ============================================
# ENTORNO
# ============================================
ENVIRONMENT=production
DEBUG=false
NODE_ENV=production

# ============================================
# BASE DE DATOS (OPCIONAL)
# ============================================
# Si usas PostgreSQL en servidor externo, configura DATABASE_URL
# Si usas PostgreSQL local (descomenta en docker-compose.yml), usa:
# DATABASE_URL=postgresql://asistencia:asistencia123@postgres:5432/asistencia_db

# Servidor externo (RECOMENDADO para producción):
DATABASE_URL=postgresql://usuario:contraseña@db-host.com:5432/asistencia_db

# Variables individuales (si prefieres no usar DATABASE_URL):
# DB_HOST=db-host.com
# DB_PORT=5432
# DB_NAME=asistencia_db
# DB_USER=usuario
# DB_PASSWORD=contraseña

# ============================================
# API - CONFIGURACIÓN
# ============================================
API_HOST=0.0.0.0
API_PORT=8000
TIMEZONE=America/Bogota

# ============================================
# SEGURIDAD - JWT
# ============================================
# ⚠️ GENERAR NUEVOS EN PRODUCCIÓN:
# Linux/Mac: openssl rand -hex 32
SECRET_KEY=CAMBIAR-EN-PRODUCCION-GENERAR-CON-OPENSSL-RAND-HEX-32
JWT_SECRET_KEY=CAMBIAR-EN-PRODUCCION-GENERAR-CON-OPENSSL-RAND-HEX-32
TOKEN_EXPIRATION_HOURS=24

# ============================================
# CORS (CONFIGURACIÓN CRÍTICA)
# ============================================
# IMPORTANTE: Especificar explícitamente los orígenes permitidos
# Formato: origen1,origen2,origen3 (separados por comas, SIN espacios)
# 
# Desarrollo local:
# CORS_ORIGINS=http://localhost:3000,http://localhost:80,http://localhost:443
#
# Producción:
CORS_ORIGINS=https://tu-dominio.com,https://www.tu-dominio.com

# ============================================
# NGINX - CONFIGURACIÓN
# ============================================
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# ============================================
# EMAIL - CONFIGURACIÓN
# ============================================
# Usar Gmail (SMTP):
# 1. Ir a: https://myaccount.google.com/apppasswords
# 2. Generar contraseña de aplicación
# 3. Usar esa contraseña en MAIL_PASSWORD

MAIL_USERNAME=tu-email@gmail.com
MAIL_PASSWORD=tu-app-password
MAIL_FROM_EMAIL=noreply@tu-email.com
MAIL_FROM_NAME=Sistema de Asistencia

# Configuración SMTP
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true

# ============================================
# AWS - RECONOCIMIENTO FACIAL (OPCIONAL)
# ============================================
# Si usas reconocimiento facial con AWS Rekognition:
AWS_ACCESS_KEY_ID=CAMBIAR-SI-USAS-AWS
AWS_SECRET_ACCESS_KEY=CAMBIAR-SI-USAS-AWS
AWS_REGION=us-east-1

# ============================================
# MIGRACIONES Y SEEDS
# ============================================
AUTO_MIGRATE=true
SEED_DATA=true

# ============================================
# CONFIGURACIÓN DE ARCHIVOS
# ============================================
MAX_FILE_SIZE=10485760
UPLOAD_DIR=recognize/data
REPORTS_DIR=public/reports
TEMP_DIR=public/temp
PASSWORD_MIN_LENGTH=8

# ============================================
# ALERTAS Y UMBRALES DE NEGOCIO
# ============================================
TARDANZAS_MAX_ALERTA=3
FALTAS_MAX_ALERTA=2
MINUTOS_TARDANZA=15

# ============================================
# SOCKET.IO - CONFIGURACIÓN
# ============================================
# El servidor Socket.IO se ejecuta en el puerto de la API (8000)
# Accesible desde Nginx en: /api/socket.io
SOCKETIO_CORS_ORIGINS=https://tu-dominio.com,https://www.tu-dominio.com

# ============================================
# NOTIFICACIONES
# ============================================
# Configurar según tu proveedor de notificaciones
NOTIFICATION_SERVICE=email

# ============================================
# CONFIGURACIÓN AVANZADA (OPCIONAL)
# ============================================
# Configuración de producción avanzada
LOG_LEVEL=info
WORKERS=4
WORKER_CLASS=uvicorn.workers.UvicornWorker
MAX_CONNECTIONS=100

# ============================================
# NOTAS IMPORTANTES
# ============================================
# 1. Base de datos:
#    - Producción: Usar servidor PostgreSQL externo
#    - Desarrollo: Descomenta postgres en docker-compose.yml
#
# 2. JWT y Seguridad:
#    - Generar secrets seguros con: openssl rand -hex 32
#    - Cambiar en cada despliegue de producción
#
# 3. CORS:
#    - NUNCA usar "*" con credenciales en producción
#    - Especificar explícitamente los orígenes permitidos
#
# 4. Email:
#    - Gmail requiere contraseña de aplicación
#    - Ver: https://support.google.com/accounts/answer/185833
#
# 5. Despliegue selectivo:
#    - Solo cambios en client → deploy client
#    - Solo cambios en server → deploy server
#    - Cambios en ambos → deploy ambos
#
# 6. Acceso después del despliegue:
#    - Cliente (Next.js): http://tu-dominio
#    - API (FastAPI): http://tu-dominio/api/docs
#    - WebSocket (Socket.IO): ws://tu-dominio/api/socket.io
